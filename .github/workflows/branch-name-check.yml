name: Check Branch Name

on:
  push:
    branches-ignore:
      - main

jobs:
  check-branch-name:
    name: Validate Branch Name
    runs-on: ubuntu-latest
    steps:
      - name: Get Branch Name
        id: branch-name
        run: echo "BRANCH_NAME=${GITHUB_REF#refs/heads/}" >> $GITHUB_ENV

      - name: Skip validation for auto-generated branches
        run: |
          if [[ "$BRANCH_NAME" == *patch* ]]; then
            echo "ðŸ”„ Skipping branch name validation for auto-generated branch: $BRANCH_NAME"
            exit 0
          fi

      - name: Allow specific manually created branches
        run: |
          if [[ "$BRANCH_NAME" =~ ^(develop|test|release|demo|sample)$ ]]; then
            echo "âœ… Allowed branch: $BRANCH_NAME"
            exit 0
          fi

      - name: Validate Branch Name
        run: |
          if [[ ! "$BRANCH_NAME" =~ ^(feature|fix|hotfix|release)/[a-z0-9._-]+$ ]]; then
            echo "ðŸš¨ Error: Branch name '$BRANCH_NAME' does not follow the naming convention."
            echo "Valid formats: feature/XXX, fix/XXX, hotfix/XXX, release/XXX, or allowed branch names (develop, test, release, demo, sample, *patch*)."
            exit 1
          fi
          echo "âœ… Branch name '$BRANCH_NAME' follows the naming convention."
